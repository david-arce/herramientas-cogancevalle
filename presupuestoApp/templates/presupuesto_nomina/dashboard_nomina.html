<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Presupuesto - Configuraci√≥n</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 30px;
        }
        h2 {
            text-align: center;
        }
        .grid-acciones {
            max-width: 800px;
            margin: 20px auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        .acciones {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .acciones label {
            font-size: 14px;
            font-weight: bold;
        }
        input[type="number"] {
            padding: 6px;
            width: 120px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .btn-group {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 20px;
        }
        button {
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            margin: 0 5px;
        }
        button:hover {
            background: #0056b3;
        }
        #btnTabla {
            background: #6c757d;
        }
        #btnTabla:hover {
            background: #5a6268;
        }
        #resultado {
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
            color: green;
        }
    </style>
</head>
<body>
    <h2>Presupuesto N√≥mina - Par√°metros</h2>
    <a href="{% url 'exportar_excel' %}" 
   style="float: right; background-color:#28a745; color:white; padding:8px 16px; 
          border-radius:6px; text-decoration:none;">
    üìä Exportar Todo a Excel
</a>

    <!-- Formulario solo para el bot√≥n Ir a la tabla -->
    <form id="formTabla" method="get">
        <div class="grid-acciones">
            <div class="acciones">
                <label for="incrementoSalarial">Incremento salarial (%):</label>
                <input type="number" id="incrementoSalarial" name="incrementoSalarial" value="{{ parametros.incremento_salarial|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="incrementoIPC">Incremento IPC (%):</label>
                <input type="number" id="incrementoIPC" name="incrementoIPC" value="{{ parametros.incremento_ipc|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="auxilioTransporte">Auxilio de transporte (%):</label>
                <input type="number" id="auxilioTransporte" name="auxilioTransporte" value="{{ parametros.auxilio_transporte|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="cesantias">Cesant√≠as (%):</label>
                <input type="number" id="cesantias" name="cesantias" value="{{ parametros.cesantias|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="interesesCesantias">Intereses cesant√≠as (%):</label>
                <input type="number" id="interesesCesantias" name="interesesCesantias" value="{{ parametros.intereses_cesantias|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="prima">Prima (%):</label>
                <input type="number" id="prima" name="prima" value="{{ parametros.prima|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="vacaciones">Vacaciones (%):</label>
                <input type="number" id="vacaciones" name="vacaciones" value="{{ parametros.vacaciones|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="salarioMinimo">Salario m√≠nimo:</label>
                <input type="number" id="salarioMinimo" name="salarioMinimo" value="{{ parametros.salario_minimo|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>
            <div class="acciones">
                <label for="incrementoComisiones">Incremento comisiones (%):</label>
                <input type="number" id="incrementoComisiones" name="incrementoComisiones" value="{{ parametros.incremento_comisiones|default_if_none:''|cut:','}}" min="0" step="0.01">
            </div>

            <!-- Botones -->
            <div class="btn-group">
                <button type="button" id="btnActualizar">Actualizar datos</button>
                <button type="submit" id="btnTabla" formaction="{% url 'sueldos' %}">Sueldos</button>
                <button type="submit" id="btnTabla" formaction="{% url 'comisiones' %}">Comisiones</button>
                <button type="submit" id="btnTabla" formaction="{% url 'horas_extra' %}">Horas extras</button>
                <button type="submit" id="btnTabla" formaction="{% url 'medios_transporte' %}">Medios de transporte</button>
                <button type="submit" id="btnTabla" formaction="{% url 'auxilio_transporte' %}">Auxilio de transporte</button>
                <button type="submit" id="btnTabla" formaction="{% url 'ayuda_transporte' %}">Ayuda al transporte</button>
                <button type="submit" id="btnTabla" formaction="{% url 'cesantias' %}">Cesantias</button>
                <button type="submit" id="btnTabla" formaction="{% url 'intereses_cesantias' %}">Intereses cesantias</button>
                <button type="submit" id="btnTabla" formaction="{% url 'prima' %}">Prima</button>
                <button type="submit" id="btnTabla" formaction="{% url 'vacaciones' %}">Vacaciones</button>
                <button type="submit" id="btnTabla" formaction="{% url 'bonificaciones' %}">Bonificaciones</button>
                <button type="submit" id="btnTabla" formaction="{% url 'auxilio_movilidad' %}">Auxilio movilidad</button>
                <button type="submit" id="btnTabla" formaction="{% url 'seguridad_social' %}">Seguridad social</button>
                <button type="submit" id="btnTabla" formaction="{% url 'aprendiz' %}">Aprendiz</button>
                <button type="submit" id="btnTabla" formaction="{% url 'bonificaciones_foco' %}">Bonificaciones foco</button>
                <button type="submit" id="btnTabla" formaction="{% url 'auxilio_educacion' %}">Auxiliar educacion</button>
                <button type="submit" id="btnTabla" formaction="{% url 'bonos_kyrovet' %}">Bonos kyrovet</button>
            </div>
        </div>
    </form>

    <div id="resultado"></div>

    <script>
        document.getElementById("btnActualizar").addEventListener("click", function () {
            let formData = new FormData();
            formData.append("incrementoSalarial", document.getElementById("incrementoSalarial").value);
            formData.append("incrementoIPC", document.getElementById("incrementoIPC").value);
            formData.append("auxilioTransporte", document.getElementById("auxilioTransporte").value);
            formData.append("cesantias", document.getElementById("cesantias").value);
            formData.append("interesesCesantias", document.getElementById("interesesCesantias").value);
            formData.append("prima", document.getElementById("prima").value);
            formData.append("vacaciones", document.getElementById("vacaciones").value);
            formData.append("salarioMinimo", document.getElementById("salarioMinimo").value);
            formData.append("incrementoComisiones", document.getElementById("incrementoComisiones").value);

            fetch("", {
                method: "POST",
                body: formData,
                headers: {"X-Requested-With": "XMLHttpRequest", "X-CSRFToken": "{{ csrf_token }}"}
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("resultado").innerText = data.msg;
                document.getElementById("resultado").style.color = "green";
            })
            .catch(error => {
                document.getElementById("resultado").innerText = "‚ùå Error al guardar";
                document.getElementById("resultado").style.color = "red";
            });
        });
    </script>
</body>
</html>
